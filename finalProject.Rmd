---
title: "Final Project"
author: "Walker M Johnpaul C"
date: "2024-04-04"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


head
```{r}

#install.packages("freqparcoord")
#install.packages("regclass")
library(freqparcoord)
library(dplyr)
library(car)
data(prgeng)
head(prgeng)

```


correlation matrix
```{r}
cor(prgeng)
```
High correlations between cit, birth, and yrentry
```{r}
pairs(prgeng)
```


initial model with all variables

```{r}
bigmodel<-lm(wageinc~age+ educ+engl+occ+birth+factor(sex)+wkswrkd+yrentry+powspuma+cit, data =prgeng)
sumBig<-summary(bigmodel)
sumBig
```

```{r}
anova(bigmodel)
```



vif 
```{r}
vifs<-vif(bigmodel)
vifs
```

These three have multicollinearity lets kick them and test 
```{r}
high_vif_vars <- names(vifs[vifs > 10])
high_vif_vars
```

get rid of yrentry and cit
```{r}
reducedBirth<-lm(wageinc~age+ educ+engl+occ+factor(sex)+wkswrkd+powspuma+birth, data =prgeng)
summary(reducedBirth)
```


```{r}
vifreducedBirth<-vif(reducedBirth)
vifreducedBirth
```


Looking at different combos and individual predictors, birth seems to be the best of 3 multicollinear variables to keep.

```{r}
f_test_result <- anova(reducedBirth,bigmodel)
f_test_result
```

